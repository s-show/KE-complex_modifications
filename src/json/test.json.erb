{
  "title": "TEST!",
  "rules": [
    {
      "description": "test to_delayed_action",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("a", ["control"]) %>,
          "to": [
            {
              "set_variable": {
                "name": "ctrl-a",
                "value": 1
              }
            }
          ],
          "to_delayed_action": {
            "to_if_invoked": [
              {
                "set_variable": {
                  "name": "ctrl-a",
                  "value": 2
                }
              }
            ],
            "to_if_canceled": [
              {
                "set_variable": {
                  "name": "ctrl-a",
                  "value": 0
                }
              }
            ]
          }
        }
      ]
    },
    {
      "description": "any key_code",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("any") %>,
          "to": <%= to(["a"]) %>
        }
      ]
    },
    {
      "description": "test lazy",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("right_command") %>,
          "to": [
            {
              "key_code": "left_control",
              "lazy": true
            }
          ]
        },
        {
          "type": "basic",
          "from": <%= from("9") %>,
          "to": <%= to(["q"]) %>
        }
      ]
    },
    {
      "description": "test modifier 'A'",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("b", ["a"]) %>,
          "to": [
            {
              "key_code": "left_arrow",
              "lazy": true
            }
          ]
        }
      ]
    },
    {
      "description": "テンキー上のピリオド２回でコンマ入力",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("keypad_period") %>,
          "to": [
            <%# 下の"to"で入力された"keypad_period"を削除して"comma"を入力する %>
            { "key_code": "delete_or_backspace" },
            { "key_code": "comma" },
            <%= set_variable(["press_period_key"], [0]) %>
          ],
          "conditions": [
            <%= variable_if(["press_period_key"], [1]) %>
          ]
        },
        {
          "type": "basic",
          "from": <%= from("keypad_period") %>,
          "to": [
            <%= set_variable(["press_period_key"], [1]) %>,
            { "key_code": "keypad_period"}
          ],
          "to_delayed_action": {
            "to_if_invoked": [
              <%= set_variable(["press_period_key"], [0]) %>
            ],
            "to_if_canceled": [
              <%= set_variable(["press_period_key"], [0]) %>
            ]
          },
          "conditions": [
            <%= variable_if(["press_period_key"], [0]) %>
          ]
        }
      ]
    },
    {
      "description": "Double tap 'left_control'",
      <%# Gistにも掲載中 https://gist.github.com/s-show/4afc5ca6a00d39a87a762fd4d4a7249b %>
      "comment": "この設定は期待どおりの動作になる。",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("left_control") %>,
          "to": [
            { "shell_command": "open -a 'safari'" }
          ],
          "conditions": [
            <%= variable_if(["left_control_key"], [1]) %>
          ]
        },
        {
          "type": "basic",
          "from": <%= from("left_control", [], ["any"]) %>,
          "to": [
            <%= set_variable(["left_control_key"], [1]) %>,
            { "key_code": "left_control"}
          ],
          "to_delayed_action": {
            "to_if_invoked": [
              <%= set_variable(["left_control_key"], [0]) %>
            ],
            "to_if_canceled": [
              <%= set_variable(["left_control_key"], [0]) %>
            ]
          },
          "conditions": [
            <%= variable_if(["left_control_key"], [0]) %>
          ]
        }
      ]
    },
    {
      "description": "pointing_button in 'from'",
      "manipulators": [
        {
          "type": "basic",
          "from": { "pointing_button": "button3" },
          "to": <%= to([["t", ["command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("finder") %>
          ]
        }
      ]
    },
    {
      "description": "Test 'frontmost_application_if > file_paths'",
      "manipulators": [
        {
          "type": "basic",
          "from": {
            "pointing_button": "button1",
            "modifiers": {
              "mandatory": [
                "command"
              ]
            }
          },
          "to": <%= to([["t", ["command"]]]) %>,
          "conditions": [
            {
              "type": "frontmost_application_if",
              "file_paths": [
                "/System/Library/CoreServices/Finder.app/Contents/MacOS/Finder"
              ]
            }
          ]
        }
      ]
    },
    {
      "description": "Optionキーを押したらメニューバーにフォーカスを当てる",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("left_option", [], ["caps_lock"]) %>,
          "to": <%= to(["left_option"]) %>,
          "to_if_alone": [
            {
              "key_code": "f2",
              "modifiers": [ "control" ],
              "lazy": true
            }
          ]
        },
        {
          "type": "basic",
          "from": <%= from("right_option", [], ["caps_lock"]) %>,
          "to": <%= to(["right_option"]) %>,
          "to_if_alone": [
            {
              "key_code": "f2",
              "modifiers": [ "control" ],
              "lazy": true
            }
          ]
        }
      ]
    },
    {
      "description": "command-Enter to Double Click",
      "comment": "cmd-enterをダブルクリックにしようとしたがうまくいかなかった",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("return_or_enter", ["command"]) %>,
          "to": [
            { "pointing_button": "button1" },
            { "pointing_button": "button1" }
          ],
          "conditions": [
            <%= frontmost_application_if("finder") %>
          ]
        }
      ]
    }
  ]
}
