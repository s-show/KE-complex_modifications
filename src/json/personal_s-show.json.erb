{
  "title": "Personal rules (@s-show)",
  "rule_list": false,
  "make_extra_description": true,
  "rules": [
    {
      "description": "command-E Open Finder",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("e", ["command"], ["any"]) %>,
          "to": <%= set_shell_command(["open -a 'finder'"]) %>,
          "conditions": [
            <%= frontmost_application_unless("remote_desktop") %>
          ]
        }
      ]
    },
    {
      "description": "control-Esc Open LaunchPad",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("escape", ["control"], []) %>,
          "to": <%= to(["vk_launchpad"]) %>,
          "conditions": [
            <%= frontmost_application_unless("remote_desktop") %>
          ]
        }
      ]
    },
    {
      "description": "If open 'Alfred' at IME ON, IME OFF before open Alfred",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("spacebar", ["option"], ["any"]) %>,
          "to":
            <%= to([ ["japanese_eisuu"], ["spacebar", ["option"]] ]) %>,
          "conditions": [
            <%# input_source_ifメソッドは自作 %>
            <%= input_source_if("ja") %> 
          ]
        }
      ]
    },
    {
      "description": "CapsLock to Japanese_eisuu, shift-CapsLock to CapsLock toggle.",
      "manipulators": [
        {
          <%# 参考：KE-complex_modifications/caps_lock.json at master ·pqrs-org/KE-complex_modifications %>
          <%# https://github.com/pqrs-org/KE-complex_modifications/blob/master/docs/json/caps_lock.json %>
          "type": "basic",
          "from": <%= from("caps_lock", ["shift"], ["caps_lock"]) %>,
          "to": <%= to(["caps_lock"]) %>
        },
        {
          "type": "basic",
          "from": <%= from("caps_lock", [], ["any"]) %>,
          "to": <%= to(["japanese_eisuu"]) %>
        }
      ]
    },
    {
      "description": "Application_key(or shift-F10) to Right Click",
      "manipulators": [
        {
          <%# Application_key to Right Click %>
          "type": "basic",
          "from": <%= from("application", [], ["any"]) %>,
          "to": <%= to(["button2"]) %>,
          "conditions": [
            <%= frontmost_application_unless("remote_desktop") %>
          ]
        },
        {
          <%# この組み合わせには、optionalにcaps_lockの指定が必要 %>
          "type": "basic",
          "from": <%= from("f10", ["shift"], ["caps_lock"]) %>,
          "to": <%= to(["button2"]) %>,
          "conditions": [
            <%= frontmost_application_unless("remote_desktop") %>
          ]
        }
      ]
    },
    {
      "description": "PrintScreen_key Screenshot(full Screen)",
      "extra_descriptions": [
        "Screenshot save in ~/Desktop/screenshot-yyyymmdd-hhmmss",
        "PrintScreen_key -> Screenshot",
        "PrintScreen_key-p -> Screenshot and Preview",
        "スクリーンショットは、'~/Desktop/screenshot-yyyymmdd-hhmmss'というファイル名で保存されます",
        "PrintScreenで、スクリーンショットの撮影（画面全体）のみ行います",
        "PrintScreen-Pで、スクリーンショット（画面全体）を撮影した後プレビューします。"
      ],
      "extra_description_level": 1,
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("print_screen", [], ["caps_lock"]) %>,
          "to": <%= to(["fn"]) %>,
          <%# PrintScreenキー単独で押したときはスクリーンショット撮影のみ行う %>
          "to_if_alone": <%= set_shell_command(["screencapture ~/Desktop/screenshot-`date +%Y%m%d-%H%M%S`.png"]) %>,
          "conditions": [
            <%= frontmost_application_unless("remote_desktop") %>
          ]
        },
        {
          "type": "basic",
          "from": <%= from("p", ["fn"], ["caps_lock"]) %>,
          <%# PrintScreenキー + Pキーで押したときは、スクリーンショットを撮影してプレビューする %>
          "to": <%= set_shell_command(["screencapture -P ~/Desktop/screenshot-`date +%Y%m%d-%H%M%S`.png"]) %>
        }
      ]
    },
    {
      "description": "Option-PrintScreen Screenshot(Select Window)",
      "extra_descriptions": [
        "Screenshot save in ~/Desktop/screenshot-yyyymmdd-hhmmss",
        "option-PrintScreen -> Screenshot",
        "スクリーンショットは、'~/Desktop/screenshot-yyyymmdd-hhmmss'というファイル名で保存されます",
        "option-PrintScreenで、スクリーンショット（ウィンドウ選択モード）の撮影のみ行います"
      ],
      "extra_description_level": 1,
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("print_screen", ["option"], ["caps_lock"]) %>,
          "to": <%= set_shell_command(["screencapture -oW ~/Desktop/screenshot-`date +%Y%m%d-%H%M%S`.png"]) %>,
          "conditions": [
            <%= frontmost_application_unless("remote_desktop") %>
          ]
        }
      ]
    },
    {
      "description": "Finder(Delete to command-delete(delete file))",
      "extra_descriptions": [
        "Windows like key_bind",
        "Windowsと同様に、Deleteでファイルが削除できます"
      ],
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("delete_forward", [], ["any"]) %>,
          "to": <%= to([["delete_or_backspace", ["command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("finder") %>
          ]
        }
      ]
    },
		{
			"description": "ATOM(Esc (or Control-[) sends Esc Japanese_eisuu Esc Esc Esc)",
      "extra_descriptions": [
        "This key_bind for 'vim-mode-plus'",
        "Send Esc, Eisu, Esc, Esc and Esc to stop changing at IME, disable IME and change to Normal mode at atom(with vim-mode-plus) at once.",
        "このキーバインドは、ATOMに'vim-mode-plus'をインストールしている場合に役立ちます",
        "Escを押すと、'Esc + 英数 + Esc + Esc + Esc'とキーを送ることで、変換途中でもIMEをオフにした上でノーマルモードに切り替わります。"
      ],
      "manipulators":
      <%=
        each_key(
          source_keys_list: ["escape", hash_from("close_bracket", ["control"])],
          dest_keys_list: [[], []],
          to_post_events: ["escape", "japanese_eisuu", "escape", "escape", "escape"],
          conditions: [frontmost_application_if("atom", false)],
          as_json: true
        )
      %>
		},
		{
			"description": "ATOM('control-spacebar' to 'shift-command-P')",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("spacebar", ["control"], ["caps_lock"]) %>,
          "to": <%= to([["p", ["shift", "command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("atom") %>
          ]
        }
      ]
		},
		{
			"description": "Browser(F5 to command-R)",
			<%# firefoxは最初から設定済み %>
      "extra_descriptions": [
        "For Chrome, Safari",
        "This setting is accomplished in Firefox from a beginning.",
        "この設定はChromeとSafari用です。FirefoxはF5キーで更新する初期設定になっています。"
      ],
			"manipulators": [
				{
					"type": "basic",
          "from": <%= from("f5", [], ["any"]) %>,
          "to": <%= to([["r", ["left_command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("chrome_and_safari") %>
          ]
				}
			]
		},
		{
			"description": "Browser(option-Home to homepage)",
			<%# firefoxは最初から設定済み %>
      "extra_descriptions": [
        "For Chrome, Safari",
        "This setting is accomplished in Firefox from a beginning.",
        "この設定はChromeとSafari用です。FirefoxはF5キーで更新する初期設定になっています。"
      ],
			"manipulators": [
				{
					"type": "basic",
          "from": <%= from("home", ["option"], ["any"]) %>,
          "to": <%= to([["h", ["left_command", "left_shift"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("chrome_and_safari") %>
          ]
				}
			]
		},
		{
      "description": "Next/Prev by option-Left/Right arrow at browser",
      "extra_descriptions": [
        "For Chrome, Safari, Firefox."
      ],
      "manipulators": [
				{
					"type": "basic",
          "from": <%= from("right_arrow", ["option"], []) %>,
          "to": <%= to([["backslash", ["command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("browser") %>
          ]
				},
				{
					"type": "basic",
          "from": <%= from("left_arrow", ["option"], []) %>,
          "to": <%= to([["close_bracket", ["command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("browser") %>
          ]
				}
      ]
		},
		{
			"description": "Chrome(command-L send command-L, Japanese_eisuu)",
      "extra_descriptions": [
        "The Japanese hardly inputs Japanese in an address bar."
      ],
			<%# URL入力で日本語を入力する機会はほとんどないため %>
			<%# CapsLockがONでも変換する %>
			"manipulators": [
				{
					"type": "basic",
          "from": <%= from("l", ["command"], ["caps_lock"]) %>,
          "to": <%= to([["l", ["command"]], ["japanese_eisuu"]]) %>,
          "conditions": [
            <%= frontmost_application_if("chrome") %>
          ]
				}
			]
		},
		{
			"description": "Safari(Next_tab/Prev_tab by control-Pagedown/Pageup at Safari)",
			<%# Chromeとfirefoxは最初から設定済み %>
			"manipulators": [
				{
					"type": "basic",
          "from": <%= from("page_down", ["control"], ["caps_lock"]) %>,
          "to": <%= to([["tab", ["control"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("safari") %>
          ]
				},
				{
					"type": "basic",
          "from": <%= from("page_up", ["control"], ["caps_lock"]) %>,
          "to": <%= to([["tab", ["control", "shift"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("safari") %>
          ]
				}
			]
		},
		{
			"description": "Terminal(Next_tab/Prev_tab by control-Pagedown/Pageup at Terminal)",
			"manipulators": [
				{
					"type": "basic",
          "from": <%= from("page_down", ["control"], ["caps_lock"]) %>,
          "to": <%= to([["tab", ["control"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("terminal") %>
          ]
				},
				{
					"type": "basic",
          "from": <%= from("page_up", ["control"], ["caps_lock"]) %>,
          "to": <%= to([["tab", ["control", "shift"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("terminal") %>
          ]
				}
			]
		},
		{
			"description": "iTerm2(Next_Pane/Prev_Pane by control-Pagedown/Pageup at iTerm2)",
			"manipulators": [
				{
					"type": "basic",
          "from": <%= from("page_down", ["control"], ["caps_lock"]) %>,
          "to": <%= to([["backslash", ["command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("iterm2") %>
          ]
				},
				{
					"type": "basic",
          "from": <%= from("page_up", ["control"], ["caps_lock"]) %>,
          "to": <%= to([["close_bracket", ["command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("iterm2") %>
          ]
				}
			]
		},
    {
      "description": "Double tap 'keypad_period' to 'comma'",
      <%# Gistにも掲載中 https://gist.github.com/s-show/335f2b7c9d5bf9fcc8e7326c10ee0113 %>
      "extra_description_level": 1,
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("keypad_period") %>,
          "to": [
            <%# 下の"to"で入力された"keypad_period"を削除して"comma"を入力する %>
            { "key_code": "delete_or_backspace" },
            { "key_code": "comma" },
            <%= set_variable(["press_period_key"], [0]) %>
          ],
          "conditions": [
            <%= variable_if(["press_period_key"], [1]) %>,
            <%= input_source_if("en") %>
          ]
        },
        {
          "type": "basic",
          "from": <%= from("keypad_period") %>,
          "to": [
            <%# IMEがOFFにしないと"comma"が全角カンマとして入力されてしまうため、IMEをOFFにする。 %>
            {
              "select_input_source": {
                "input_source_id": "^com\\.apple\\.inputmethod\\.Kotoeri\\.Roman$"
              }
            },
            <%# 下の"to"で入力された"keypad_period"を削除して"comma"を入力する %>
            { "key_code": "delete_or_backspace" },
            { "key_code": "comma" },
            <%= set_variable(["press_period_key"], [0]) %>,
            <%# いったんOFFにしたIMEをONに戻す %>
            {
              "select_input_source": {
                "input_source_id": "^com\\.apple\\.inputmethod\\.Kotoeri\\.Japanese$"
              }
            }
          ],
          "conditions": [
            <%= variable_if(["press_period_key"], [1]) %>,
            <%= input_source_if("ja") %>
          ]
        },
        {
          "type": "basic",
          "from": <%= from("keypad_period") %>,
          "to": [
            <%= set_variable(["press_period_key"], [1]) %>,
            { "key_code": "keypad_period"}
          ],
          "to_delayed_action": {
            "to_if_invoked": [
              <%= set_variable(["press_period_key"], [0]) %>
            ],
            "to_if_canceled": [
              <%= set_variable(["press_period_key"], [0]) %>
            ]
          },
          "conditions": [
            <%= variable_if(["press_period_key"], [0]) %>
          ]
        }
      ]
    },
    {
      "description": "Finder(middle click to command-t)",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("button3", [], ["caps_lock"]) %>,
          "to": <%= to([["t", ["command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("finder") %>
          ]
        }
      ]
    },
    {
      "description": "Finder(option-Enter to command-I (Show the Get Info window for a selected file.))",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("return_or_enter", ["option"], ["caps_lock"]) %>,
          "to": <%= to([["i", ["command"]]]) %>,
          "conditions": [
            <%= frontmost_application_if("finder") %>
          ]
        }
      ]
    },
    {
      "description": "Quit application by holding command-q(1000ms)",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("q", ["command"], ["caps_lock"]) %>,
          "parameters": {
              "basic.to_if_held_down_threshold_milliseconds": 1000
          },
          "to_if_held_down":[
            {
              "key_code": "q",
              "modifiers": [
                "command"
              ],
              "repeat": false
            }
          ]
        }
      ]
    },
    {
      "description": "無変換 + d -> delete",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("international5", ["any"]) %>,
          "to": <%= to([["fn", nil, true]]) %>,
          "to_if_alone": <%= to(["japanese_eisuu"]) %>
        },
        {
          "type": "basic",
          "from": <%= from("d", ["fn"], ["shift", "control", "caps_lock"]) %>,
          "to": <%= to(["delete_forward"]) %>
        }
      ]
    },
    {
      "description": "option to control-F2 (focus on the menu bar)",
      "manipulators": [
        {
          "type": "basic",
          "from": <%= from("left_option", [], ["caps_lock"]) %>,
          "to": <%= to(["left_option"]) %>,
          "to_if_alone": <%= to([["f2", ["control"]]]) %>
        },
        {
          "type": "basic",
          "from": <%= from("right_option", [], ["caps_lock"]) %>,
          "to": <%= to(["right_option"]) %>,
          "to_if_alone": <%= to([["f2", ["control"]]]) %>
        }
      ]
    }
  ]
}
